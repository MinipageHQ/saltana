(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{1874:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var tslib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__),pro_gallery_lib__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(73),pro_gallery_lib__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(49),pro_gallery_lib__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(100),VideoItem=function(_super){function VideoItem(props){var _this=_super.call(this,props)||this;return _this.pause=_this.pause.bind(_this),_this.play=_this.play.bind(_this),_this.playVideoIfNeeded=_this.playVideoIfNeeded.bind(_this),_this.state={playedOnce:!1,loadVideo:props.loadVideo||props.playing,playing:!1,reactPlayerLoaded:!1,vimeoPlayerLoaded:!1,hlsPlayerLoaded:!1},_this}return Object(tslib__WEBPACK_IMPORTED_MODULE_0__.c)(VideoItem,_super),VideoItem.prototype.componentDidMount=function(){this.dynamiclyImportVideoPlayers()},VideoItem.prototype.dynamiclyImportVideoPlayers=function(){var _this=this;pro_gallery_lib__WEBPACK_IMPORTED_MODULE_2__.a&&pro_gallery_lib__WEBPACK_IMPORTED_MODULE_2__.a.ReactPlayer||__webpack_require__.e(46).then(__webpack_require__.t.bind(null,1850,7)).then((function(ReactPlayer){pro_gallery_lib__WEBPACK_IMPORTED_MODULE_2__.a.ReactPlayer=ReactPlayer.default,_this.setState({reactPlayerLoaded:!0}),_this.playVideoIfNeeded()})),pro_gallery_lib__WEBPACK_IMPORTED_MODULE_2__.a&&pro_gallery_lib__WEBPACK_IMPORTED_MODULE_2__.a.Vimeo||!this.props.videoUrl||!this.props.videoUrl.includes("vimeo.com")||__webpack_require__.e(47).then(__webpack_require__.bind(null,1867)).then((function(Player){pro_gallery_lib__WEBPACK_IMPORTED_MODULE_2__.a.Vimeo={Player:Player.default},_this.setState({vimeoPlayerLoaded:!0}),_this.playVideoIfNeeded()})),pro_gallery_lib__WEBPACK_IMPORTED_MODULE_2__.a&&pro_gallery_lib__WEBPACK_IMPORTED_MODULE_2__.a.Hls||!this.isHLSVideo()||__webpack_require__.e(45).then(__webpack_require__.t.bind(null,1868,7)).then((function(Player){pro_gallery_lib__WEBPACK_IMPORTED_MODULE_2__.a.Hls=Player.default,_this.setState({hlsPlayerLoaded:!0}),_this.playVideoIfNeeded()}))},VideoItem.prototype.isHLSVideo=function(){return this.props.videoUrl&&(this.props.videoUrl.includes("/hls")||this.props.videoUrl.includes(".m3u8"))},VideoItem.prototype.shouldUseHlsPlayer=function(){return this.isHLSVideo()&&!pro_gallery_lib__WEBPACK_IMPORTED_MODULE_3__.a.isiOS()},VideoItem.prototype.shouldForceVideoForHLS=function(){return this.isHLSVideo()&&pro_gallery_lib__WEBPACK_IMPORTED_MODULE_3__.a.isiOS()},VideoItem.prototype.UNSAFE_componentWillReceiveProps=function(nextProps){(nextProps.playing||nextProps.firstUserInteractionExecuted)&&this.setState({loadVideo:!0}),this.playVideoIfNeeded(nextProps)},VideoItem.prototype.componentDidUpdate=function(prevProps){prevProps.currentIdx!==this.props.currentIdx&&this.fixIFrameTabIndexIfNeeded(),"image"===prevProps.type&&"video"===this.props.type&&this.dynamiclyImportVideoPlayers(),this.playVideoIfNeeded()},VideoItem.prototype.play=function(){this.props.playVideo(this.props.idx)},VideoItem.prototype.pause=function(){this.props.pauseVideo()},VideoItem.prototype.playVideoIfNeeded=function(props){void 0===props&&(props=this.props);try{props.playingVideoIdx!==this.props.idx||this.isPlaying||(this.videoElement=this.videoElement||pro_gallery_lib__WEBPACK_IMPORTED_MODULE_2__.a.document.querySelector("#video-"+this.props.id+" video"),this.videoElement&&(this.isPlaying=!0,this.videoElement.play(),pro_gallery_lib__WEBPACK_IMPORTED_MODULE_3__.a.isVerbose()&&console.log("[VIDEO] Playing video #"+this.props.idx,this.videoElement)))}catch(e){console.error("[VIDEO] Could not play video #"+this.props.idx,this.videoElement,e)}},VideoItem.prototype.createPlayerElement=function(){var _a,_this=this;if(!pro_gallery_lib__WEBPACK_IMPORTED_MODULE_2__.a||!pro_gallery_lib__WEBPACK_IMPORTED_MODULE_2__.a.ReactPlayer||!this.state.loadVideo&&!this.props.playing)return null;var PlayerElement=pro_gallery_lib__WEBPACK_IMPORTED_MODULE_2__.a.ReactPlayer,isWiderThenContainer=this.props.style.ratio>=this.props.cubeRatio,videoDimensionsCss={width:isWiderThenContainer?"calc(100% + 1px)":"auto",height:isWiderThenContainer?"auto":"calc(100% + 1px)"};this.props.styleParams.cubeImages&&"fill"===this.props.styleParams.cubeType&&(_a=[videoDimensionsCss.height,videoDimensionsCss.width],videoDimensionsCss.width=_a[0],videoDimensionsCss.height=_a[1],videoDimensionsCss.position="absolute",videoDimensionsCss.margin="auto",videoDimensionsCss.minHeight="100%",videoDimensionsCss.minWidth="100%",videoDimensionsCss.left="-100%",videoDimensionsCss.right="-100%",videoDimensionsCss.top="-100%",videoDimensionsCss.bottom="-100%");var url=this.props.videoUrl?this.props.videoUrl:this.props.createUrl(pro_gallery_lib__WEBPACK_IMPORTED_MODULE_4__.a.urlSizes.RESIZED,pro_gallery_lib__WEBPACK_IMPORTED_MODULE_4__.a.urlTypes.VIDEO);return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(PlayerElement,{className:"gallery-item-visible video gallery-item",id:"video-"+this.props.id,width:"100%",height:"100%",url:url,alt:this.props.alt?this.props.alt:"untitled video",loop:!!this.props.styleParams.videoLoop,ref:function(player){return _this.video=player},volume:this.props.styleParams.videoSound?.8:0,playing:this.props.playing,onEnded:function(){_this.setState({playing:!1}),_this.props.actions.eventsListener(pro_gallery_lib__WEBPACK_IMPORTED_MODULE_4__.a.events.VIDEO_ENDED,_this.props)},onPause:function(){_this.setState({playing:!1})},onError:function(e){_this.props.actions.eventsListener(pro_gallery_lib__WEBPACK_IMPORTED_MODULE_4__.a.events.VIDEO_ERROR,Object(tslib__WEBPACK_IMPORTED_MODULE_0__.a)(Object(tslib__WEBPACK_IMPORTED_MODULE_0__.a)({},_this.props),{videoError:e}))},playbackRate:Number(this.props.styleParams.videoSpeed)||1,onProgress:function(){_this.state.playedOnce||_this.setState({playedOnce:!0})},onPlay:function(){_this.props.actions.eventsListener(pro_gallery_lib__WEBPACK_IMPORTED_MODULE_4__.a.events.VIDEO_PLAYED,_this.props),_this.setState({playing:!0})},onReady:function(){_this.playVideoIfNeeded(),_this.fixIFrameTabIndexIfNeeded(),_this.props.actions.setItemLoaded(),_this.setState({ready:!0})},controls:this.props.styleParams.showVideoControls,config:{file:{attributes:{controlsList:"nodownload",disablepictureinpicture:"true",muted:!this.props.styleParams.videoSound,preload:"metadata",poster:this.props.createUrl(pro_gallery_lib__WEBPACK_IMPORTED_MODULE_4__.a.urlSizes.SCALED,pro_gallery_lib__WEBPACK_IMPORTED_MODULE_4__.a.urlTypes.HIGH_RES),style:videoDimensionsCss,type:"video/mp4"},forceHLS:this.shouldUseHlsPlayer(),forceVideo:this.shouldForceVideoForHLS()}},key:"video-"+this.props.id})},VideoItem.prototype.fixIFrameTabIndexIfNeeded=function(){if(this.props.isExternalVideo){var videoGalleryItem=pro_gallery_lib__WEBPACK_IMPORTED_MODULE_2__.a.document&&pro_gallery_lib__WEBPACK_IMPORTED_MODULE_2__.a.document.getElementById("video-"+this.props.id),videoIFrames=videoGalleryItem&&videoGalleryItem.getElementsByTagName("iframe"),videoIFrame=videoIFrames&&videoIFrames[0];videoIFrame&&(this.props.currentIdx===this.props.idx?videoIFrame.setAttribute("tabIndex","0"):videoIFrame.setAttribute("tabIndex","-1"))}},VideoItem.prototype.render=function(){var _a=this.props,videoPlaceholder=_a.videoPlaceholder,hover=_a.hover,baseClassName="gallery-item-content gallery-item-visible gallery-item-preloaded gallery-item-video gallery-item video-item"+(pro_gallery_lib__WEBPACK_IMPORTED_MODULE_3__.a.isiPhone()?" ios":"");this.state.playing&&(baseClassName+=" playing"),this.state.playedOnce&&this.state.ready&&(baseClassName+=" playedOnce");var _b=this.props.imageDimensions||{},restOfDimensions=(_b.marginLeft,_b.marginTop,Object(tslib__WEBPACK_IMPORTED_MODULE_0__.f)(_b,["marginLeft","marginTop"])),video=react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div",{className:baseClassName,"data-hook":"video_container-video-player-element",key:"video_container-"+this.props.id,style:pro_gallery_lib__WEBPACK_IMPORTED_MODULE_3__.a.deviceHasMemoryIssues()||this.state.ready?{backgroundColor:"black"}:Object(tslib__WEBPACK_IMPORTED_MODULE_0__.a)({backgroundImage:"url("+this.props.createUrl(pro_gallery_lib__WEBPACK_IMPORTED_MODULE_4__.a.urlSizes.RESIZED,pro_gallery_lib__WEBPACK_IMPORTED_MODULE_4__.a.urlTypes.HIGH_RES)+")"},restOfDimensions)},this.createPlayerElement(),this.props.videoControls);return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div",{key:"video-and-hover-container"+this.props.idx},[video,videoPlaceholder,hover])},VideoItem}(__webpack_require__(88).a);__webpack_exports__.default=VideoItem}}]);