<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Availability | Stelace Docs</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="../statics/favicon-32x32.png.html" sizes="32x32">
    <link rel="manifest" href="../manifest.json.html">
    <link rel="apple-touch-icon" href="../statics/apple-touch-icon.png.html">
    <link rel="mask-icon" href="../statics/safari-pinned-tab.svg.html" color="#1055B6">
    <meta name="description" content="Search and inventory management APIs for ambitious Web platforms. Get started with our docs.">
    <meta name="theme-color" content="#1055B6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="msapplication-TileColor" content="#b91d47">
    <link rel="preload" href="../assets/css/0.styles.46429492.css" as="style"><link rel="preload" href="../assets/js/app.766e01c1.js" as="script"><link rel="preload" href="../assets/js/2.694a3f1c.js" as="script"><link rel="preload" href="../assets/js/31.d1ef4069.js" as="script"><link rel="preload" href="../assets/js/3.fd7a4b15.js" as="script"><link rel="prefetch" href="../assets/js/10.b8c248ad.js"><link rel="prefetch" href="../assets/js/11.d633998f.js"><link rel="prefetch" href="../assets/js/12.75c5478b.js"><link rel="prefetch" href="../assets/js/13.e2a7aa4d.js"><link rel="prefetch" href="../assets/js/14.c02c2328.js"><link rel="prefetch" href="../assets/js/15.214a6b30.js"><link rel="prefetch" href="../assets/js/16.deb2a46a.js"><link rel="prefetch" href="../assets/js/17.deabe744.js"><link rel="prefetch" href="../assets/js/18.bbaf71e5.js"><link rel="prefetch" href="../assets/js/19.b02c2bd7.js"><link rel="prefetch" href="../assets/js/20.9afef5b8.js"><link rel="prefetch" href="../assets/js/21.3d77181c.js"><link rel="prefetch" href="../assets/js/22.78c9f1f8.js"><link rel="prefetch" href="../assets/js/23.44519905.js"><link rel="prefetch" href="../assets/js/24.f3e5b416.js"><link rel="prefetch" href="../assets/js/25.dbb61a27.js"><link rel="prefetch" href="../assets/js/26.216862b1.js"><link rel="prefetch" href="../assets/js/27.784418eb.js"><link rel="prefetch" href="../assets/js/28.9a7749a7.js"><link rel="prefetch" href="../assets/js/29.fb3a79e8.js"><link rel="prefetch" href="../assets/js/30.3696cfbb.js"><link rel="prefetch" href="../assets/js/32.d8c4880e.js"><link rel="prefetch" href="../assets/js/33.d9fcb932.js"><link rel="prefetch" href="../assets/js/34.93cd9db4.js"><link rel="prefetch" href="../assets/js/35.37f07f62.js"><link rel="prefetch" href="../assets/js/4.15e74292.js"><link rel="prefetch" href="../assets/js/5.e5ec33ab.js"><link rel="prefetch" href="../assets/js/6.423c0c7f.js"><link rel="prefetch" href="../assets/js/7.27aa73f3.js"><link rel="prefetch" href="../assets/js/8.031db7f1.js"><link rel="prefetch" href="../assets/js/9.2537acb3.js">
    <link rel="stylesheet" href="../assets/css/0.styles.46429492.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="../index.html" class="home-link router-link-active"><!----> <span class="site-name">Stelace Docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="../../index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Stelace Home
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://docs.api.stelace.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  API Reference
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="availability.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="../fr/index.html" class="nav-link">
  Français
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="../../index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Stelace Home
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://docs.api.stelace.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  API Reference
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="availability.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="../fr/index.html" class="nav-link">
  Français
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="../getting-started.html" class="sidebar-link">Quick Start 🚀</a></li><li><section class="sidebar-group depth-0"><a href="../assets/index.html" class="sidebar-heading clickable open"><span>Search</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="../assets/index.html" class="sidebar-link">Assets</a></li><li><a href="index.html" aria-current="page" class="sidebar-link">Search</a></li><li><a href="availability.html" aria-current="page" class="active sidebar-link">Availability</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="#absolute-or-relative" class="sidebar-link">Absolute or relative</a></li><li class="sidebar-sub-header"><a href="#stacking-availabilities" class="sidebar-link">Stacking Availabilities</a></li><li class="sidebar-sub-header"><a href="#default-availability" class="sidebar-link">Default Availability</a></li><li class="sidebar-sub-header"><a href="#recurring-availability" class="sidebar-link">Recurring Availability</a></li><li class="sidebar-sub-header"><a href="#availability-graph" class="sidebar-link">Availability graph</a></li></ul></li><li><a href="../assets/categories.html" class="sidebar-link">Categories</a></li><li><a href="../assets/custom-attributes.html" class="sidebar-link">Custom Attributes</a></li><li><a href="../assets/asset-types.html" class="sidebar-link">Asset Types</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="../command/index.html" class="sidebar-heading clickable"><span>Command</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="../command/events.html" class="sidebar-link">Events</a></li><li><a href="../command/webhooks.html" class="sidebar-link">Webhooks</a></li><li><a href="../command/workflows.html" class="sidebar-link">Workflows</a></li><li><a href="../command/tasks.html" class="sidebar-link">Tasks</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Instant</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="../users.html" class="sidebar-link">Users</a></li><li><a href="../ratings.html" class="sidebar-link">Ratings</a></li><li><a href="../messages.html" class="sidebar-link">Messages</a></li><li><a href="../transactions.html" class="sidebar-link">Transactions</a></li><li><a href="../content.html" class="sidebar-link">Content Entries</a></li><li><a href="../signal.html" class="sidebar-link">Signal</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Development</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="../sdk.html" class="sidebar-link">SDK</a></li><li><a href="../metadata.html" class="sidebar-link">Metadata</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="availability"><a href="#availability" class="header-anchor">#</a> Availability</h1> <p>Availabilities are the successive or concurrent states of an Asset reachability to your business needs.</p> <p>An Availability object impacts <a href="index.html" class="router-link-active">Search</a> results according to its dates and quantity parameters.</p> <p>Availabilities can only be created for Assets having an <a href="../assets/asset-types.html#examples">Asset Type that is not <code>timeBased</code> or has <code>infiniteStock</code></a>.</p> <h2 id="absolute-or-relative"><a href="#absolute-or-relative" class="header-anchor">#</a> Absolute or relative</h2> <p>Availability can be expressed in several ways for best flexibility, using <code>startDate</code>, <code>endDate</code> and <code>quantity</code>:</p> <ul><li><em>absolute</em>: stock quantity of an Asset. For instance, a car can’t be rented out if it’s ongoing reparations, setting its quantity to <code>0</code>.</li> <li>or <em>relative</em> stock variation denoted by leading <code>+</code> or <code>-</code> sign, e.g. <code>&quot;-1&quot;</code>, due to an order of a single item.</li></ul> <p>Setting absolute stock quantity of an Asset to <code>3</code> during two days in the future just takes a single call:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">await</span> stelace<span class="token punctuation">.</span>availabilities<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  assetId<span class="token operator">:</span> <span class="token string">'ast_2l7fQps1I3a1gJYz2I3a'</span><span class="token punctuation">,</span>
  startDate<span class="token operator">:</span> <span class="token string">'2019-09-13T00:00:00.000Z'</span><span class="token punctuation">,</span>
  endDate<span class="token operator">:</span> <span class="token string">'2019-09-16T00:00:00.000Z'</span><span class="token punctuation">,</span>
  quantity<span class="token operator">:</span> <span class="token number">3</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Using curl:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">curl</span> https://api.stelace.com/availabilities <span class="token punctuation">\</span>
  -u seck_test_rylx3ebUg0bNs1HkJKlqNHkI: <span class="token punctuation">\</span>
  -d <span class="token assign-left variable">assetId</span><span class="token operator">=</span>ast_2l7fQps1I3a1gJYz2I3a <span class="token punctuation">\</span>
  -d <span class="token assign-left variable">startDate</span><span class="token operator">=</span><span class="token string">&quot;2019-09-13T00:00:00.000Z&quot;</span> <span class="token punctuation">\</span>
  -d <span class="token assign-left variable">endDate</span><span class="token operator">=</span><span class="token string">&quot;2019-09-16T00:00:00.000Z&quot;</span> <span class="token punctuation">\</span>
  -d <span class="token assign-left variable">quantity</span><span class="token operator">=</span><span class="token number">3</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Your Assets can also be available in infinite quantity, like digital goods, or their availability can have nothing to do with time frames. You can easily set this with an <a href="../assets/asset-types.html">Asset Type</a>.</p></div> <h2 id="stacking-availabilities"><a href="#stacking-availabilities" class="header-anchor">#</a> Stacking Availabilities</h2> <p>Should several <a href="#absolute-or-relative"><em>absolute</em></a> availabilities overlap, the most recently created availability takes precedence during its full date range.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">await</span> stelace<span class="token punctuation">.</span>availabilities<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  assetId<span class="token operator">:</span> <span class="token string">'ast_2l7fQps1I3a1gJYz2I3a'</span><span class="token punctuation">,</span>
  startDate<span class="token operator">:</span> <span class="token string">'2019-09-14T00:00:00.000Z'</span><span class="token punctuation">,</span>
  endDate<span class="token operator">:</span> <span class="token string">'2019-09-15T00:00:00.000Z'</span><span class="token punctuation">,</span>
  quantity<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Given the two previous API calls made above, <code>ast_2l7fQps1I3a1gJYz2I3a</code> will be unavailable during one day (<code>2019-09-14</code>), surrounded by two single days when its stock <code>quantity</code> is 3.</p> <p>Quantities of concurrent <a href="#absolute-or-relative"><em>relative</em></a> Availabilities will simply add up when overlapping.</p> <h2 id="default-availability"><a href="#default-availability" class="header-anchor">#</a> Default Availability</h2> <p>On any other day, available stock of <code>ast_2l7fQps1I3a1gJYz2I3a</code> is the <code>quantity</code> set in the Asset object itself, used as default <code>quantity</code> available.</p> <p>This means you can make an Asset unavailable by default if you set its <code>quantity</code> to 0, and use Availability API calls to make it available in specific time windows.</p> <h2 id="recurring-availability"><a href="#recurring-availability" class="header-anchor">#</a> Recurring Availability</h2> <p>An Availability can also be defined using a <code>recurringPattern</code> with <a href="https://en.wikipedia.org/wiki/Cron" target="_blank" rel="noopener">cron format<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>Here is one API call making an Asset unavailable on every Tuesday at midnight <code>&quot;0 0 * * 2&quot;</code>, for the full day:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">await</span> stelace<span class="token punctuation">.</span>availabilities<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  assetId<span class="token operator">:</span> <span class="token string">'ast_2l7fQps1I3a1gJYz2I3a'</span><span class="token punctuation">,</span>
  startDate<span class="token operator">:</span> <span class="token string">'2019-01-01T00:00:00.000Z'</span><span class="token punctuation">,</span>
  endDate<span class="token operator">:</span> <span class="token string">'2019-12-31T23:59:59.999Z'</span><span class="token punctuation">,</span>
  quantity<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  recurringPattern<span class="token operator">:</span> <span class="token string">'0 0 * * 2'</span><span class="token punctuation">,</span>
  recurringDuration<span class="token operator">:</span> <span class="token punctuation">{</span> d<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><code>recurringDuration</code> is set to one day using <code>{ d: 1 }</code> but you can also use hours <code>h</code> and minutes <code>m</code>.</p> <p>Recurring Availabilities are an advanced feature only enabled for some API plans.</p> <h2 id="availability-graph"><a href="#availability-graph" class="header-anchor">#</a> Availability graph</h2> <p>The evolution of the available Asset quantity over time can be represented by an Availability graph.
This is especially useful for users to know when an Asset is available and in what quantity, or when it’s not.</p> <p>You can design any kind of dynamic UI with Availability graph data:</p> <ul><li>disabling booking calendar dates when Asset quantity requested by user is not available</li> <li>showing the maximum available quantity for the period selected by user</li> <li>displaying some bar chart with available Asset quantity each day</li> <li>highlighting popular Assets with many ongoing <a href="../transactions.html">Transactions</a>.</li></ul> <p>Let’s explore some examples of Availability graphs and see how to interpret them.</p> <h3 id="graph-at-asset-creation"><a href="#graph-at-asset-creation" class="header-anchor">#</a> Graph at Asset creation</h3> <p>When an <a href="../assets/index.html">Asset</a> is created,</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> asset <span class="token operator">=</span> <span class="token keyword">await</span> stelace<span class="token punctuation">.</span>assets<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'My asset'</span><span class="token punctuation">,</span>
  quantity<span class="token operator">:</span> <span class="token number">5</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>the Availability graph can be retrieved via:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">await</span> stelace<span class="token punctuation">.</span>availabilities<span class="token punctuation">.</span><span class="token function">getGraph</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  assetId<span class="token operator">:</span> asset<span class="token punctuation">.</span>id
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Here’s the response:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  defaultQuantity<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
  totalUsedQuantity<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  graphDates<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>defaultQuantity</code> has the same value as <code>asset.quantity</code>. This is the available quantity by default.</p> <p><code>totalUsedQuantity</code> represents the sum of all Transaction quantities of which <code>status</code> is included in the associated <a href="../assets/asset-types.html#availability">Asset Type array property <code>unavailableWhen</code></a>.</p> <p><code>graphDates</code> is empty here because the Asset has no Availabilities or <a href="../transactions.html">Transactions</a> attached.</p> <h3 id="graph-with-availabilities"><a href="#graph-with-availabilities" class="header-anchor">#</a> Graph with Availabilities</h3> <p>Let’s now suppose the Asset owner wants to create an unavailable period:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">await</span> stelace<span class="token punctuation">.</span>availabilities<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  assetId<span class="token operator">:</span> asset<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
  startDate<span class="token operator">:</span> <span class="token string">'2019-09-01T01:12:20.000Z'</span><span class="token punctuation">,</span>
  endDate<span class="token operator">:</span> <span class="token string">'2019-09-10T09:54:10.000Z'</span><span class="token punctuation">,</span>
  quantity<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Graph:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  defaultQuantity<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
  totalUsedQuantity<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  graphDates<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// Two graph date objects have been added</span>
    <span class="token punctuation">{</span>
      date<span class="token operator">:</span> <span class="token string">'2019-09-01T01:12:20.000Z'</span><span class="token punctuation">,</span>
      usedQuantity<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      availableQuantity<span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      date<span class="token operator">:</span> <span class="token string">'2019-09-10T09:54:10.000Z'</span><span class="token punctuation">,</span>
      usedQuantity<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      availableQuantity<span class="token operator">:</span> <span class="token number">5</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Interpretation of <code>graphDates</code> (for readability, hours and minutes are omitted):</p> <ol><li>Until 2019-09-01, the <code>availableQuantity</code> is 5.</li> <li>From 2019-09-01 to 2019-09-10, the <code>availableQuantity</code> is 0.</li> <li>Finally after 2019-09-10, the <code>availableQuantity</code> is 5.</li></ol> <p>Should the Availability object created above be removed, corresponding <code>graphDates</code> objects would be removed in next requests too.</p> <p><code>graphDates</code> objects represent any changes in quantity and have three properties:</p> <ul><li><code>usedQuantity</code>: total number of units <em>used</em> by Transactions</li> <li><code>availableQuantity</code>: total number of theoretically <em>available</em> units defined by Availabilities</li> <li><code>date</code>: two previous properties only apply to dates equal to or past this <code>date</code> <strong>and</strong> before the next <code>graphDates.date</code>, if there is any</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>To get the quantity effectively available for new Transactions, you just need to compute the following:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> remainingQuantity <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>availableQuantity <span class="token operator">-</span> usedQuantity<span class="token punctuation">)</span>
</code></pre></div></div> <h3 id="graph-with-transaction"><a href="#graph-with-transaction" class="header-anchor">#</a> Graph with Transaction</h3> <p>For illustration purposes, let’s suppose Transactions consume their <code>quantity</code> of Asset units as soon as they are created.
We just have to include the default <code>status</code> <code>draft</code> in the Asset Type <a href="../assets/asset-types.html#availability">array property <code>unavailableWhen</code></a> to enable this behavior.</p> <p>A user creates a Transaction:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">await</span> stelace<span class="token punctuation">.</span>transactions<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  assetId<span class="token operator">:</span> asset<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
  startDate<span class="token operator">:</span> <span class="token string">'2019-09-14T12:42:30.000Z'</span><span class="token punctuation">,</span>
  duration<span class="token operator">:</span> <span class="token punctuation">{</span> d<span class="token operator">:</span> <span class="token number">7</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  quantity<span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Graph:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  defaultQuantity<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
  totalUsedQuantity<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  graphDates<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      date<span class="token operator">:</span> <span class="token string">'2019-09-01T01:12:20.000Z'</span><span class="token punctuation">,</span>
      usedQuantity<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      availableQuantity<span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      date<span class="token operator">:</span> <span class="token string">'2019-09-10T09:54:10.000Z'</span><span class="token punctuation">,</span>
      usedQuantity<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      availableQuantity<span class="token operator">:</span> <span class="token number">5</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// The two following objects have been added</span>
    <span class="token punctuation">{</span>
      date<span class="token operator">:</span> <span class="token string">'2019-09-14T12:42:30.000Z'</span><span class="token punctuation">,</span>
      usedQuantity<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      availableQuantity<span class="token operator">:</span> <span class="token number">5</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token comment">// 7 days later</span>
      date<span class="token operator">:</span> <span class="token string">'2019-09-21T12:42:30.000Z'</span><span class="token punctuation">,</span>
      usedQuantity<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      availableQuantity<span class="token operator">:</span> <span class="token number">5</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Interpretation:</p> <p>The two first <code>graphDates</code> objects are the same as in the previous graph.</p> <ol><li>From 2019-09-14 to 2019-09-21, the quantity available for new Transactions is 3 (<code>availableQuantity</code> - <code>usedQuantity</code> = 5 - 2 = 3).</li> <li>After 2019-09-21, the <code>availableQuantity</code> is 5, same as quantity available for new Transactions since <code>usedQuantity</code> is zero.</li></ol> <p>Note: root property <code>totalUsedQuantity</code> of Availability graph has been updated. The new value is equal to the quantity consumed by the Transaction.</p> <h3 id="graph-with-overlapping-transactions"><a href="#graph-with-overlapping-transactions" class="header-anchor">#</a> Graph with overlapping Transactions</h3> <p>From 2019-09-14 to 2019-09-21, there is still room for new Transactions with quantity lower or equal to 3.</p> <p>Let’s create one:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">await</span> stelace<span class="token punctuation">.</span>transactions<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  assetId<span class="token operator">:</span> asset<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
  startDate<span class="token operator">:</span> <span class="token string">'2019-09-16T18:34:50.000Z'</span><span class="token punctuation">,</span>
  duration<span class="token operator">:</span> <span class="token punctuation">{</span> d<span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  quantity<span class="token operator">:</span> <span class="token number">3</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Graph:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  defaultQuantity<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
  totalUsedQuantity<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
  graphDates<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      date<span class="token operator">:</span> <span class="token string">'2019-09-01T01:12:20.000Z'</span><span class="token punctuation">,</span>
      usedQuantity<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      availableQuantity<span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      date<span class="token operator">:</span> <span class="token string">'2019-09-10T09:54:10.000Z'</span><span class="token punctuation">,</span>
      usedQuantity<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      availableQuantity<span class="token operator">:</span> <span class="token number">5</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      date<span class="token operator">:</span> <span class="token string">'2019-09-14T12:42:30.000Z'</span><span class="token punctuation">,</span>
      usedQuantity<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      availableQuantity<span class="token operator">:</span> <span class="token number">5</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// the two following graphDates objects have been inserted</span>
    <span class="token punctuation">{</span>
      date<span class="token operator">:</span> <span class="token string">'2019-09-16T18:34:50.000Z'</span><span class="token punctuation">,</span>
      usedQuantity<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
      availableQuantity<span class="token operator">:</span> <span class="token number">5</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      date<span class="token operator">:</span> <span class="token string">'2019-09-19T18:34:50.000Z'</span><span class="token punctuation">,</span>
      usedQuantity<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      availableQuantity<span class="token operator">:</span> <span class="token number">5</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token punctuation">{</span>
      date<span class="token operator">:</span> <span class="token string">'2019-09-21T12:42:30.000Z'</span><span class="token punctuation">,</span>
      usedQuantity<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      availableQuantity<span class="token operator">:</span> <span class="token number">5</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Interpretation:</p> <p>Now, from 2019-09-16 to 2019-09-19 (the second transaction period), there is no more quantity available for new Transactions.</p> <p>Bravo! You’re an expert on reading Availability graphs and you can now use them to build your app faster.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="index.html" class="prev router-link-active">
        Search
      </a></span> <span class="next"><a href="../assets/categories.html">
        Categories
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="../assets/js/app.766e01c1.js" defer></script><script src="../assets/js/2.694a3f1c.js" defer></script><script src="../assets/js/31.d1ef4069.js" defer></script><script src="../assets/js/3.fd7a4b15.js" defer></script>
  </body>
</html>
